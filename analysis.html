<!DOCTYPE html>
<html>

<!-- Head -->
<head>

<title>Home</title>

<!-- Meta-Tags -->
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="keywords" content="">
<script type="application/x-javascript"> addEventListener("load", function() { setTimeout(hideURLbar, 0); }, false); function hideURLbar(){ window.scrollTo(0,1); } </script>
<!-- //Meta-Tags -->

<!-- Custom-Stylesheet-Links -->
<!-- Bootstrap-CSS --> 	<link rel="stylesheet" href="css/bootstrap.min.css"	type="text/css" media="all">
<!-- Index-Page-CSS --> <link rel="stylesheet" href="css/style.css" 		type="text/css" media="all">
<!-- Portfolio-CSS --> 	<link rel="stylesheet" href="css/smoothbox.css" 	type="text/css" media="all">
<!-- //Custom-Stylesheet-Links -->

<!--<link rel="stylesheet" href="http://fonts.googleapis.com/css?family=Open+Sans:400,300,600,700"		type="text/css" media="all">
<link rel="stylesheet" href="http://fonts.googleapis.com/css?family=Neuton:300,400,700,800" 		type="text/css" media="all">
<link rel="stylesheet" href="http://fonts.googleapis.com/css?family=Roboto:400,100,300,500,700,900" type="text/css" media="all"> -->

<!-- Font-Awesome-File-Links -->
<!-- CSS --> <link rel="stylesheet" href="css/font-awesome.min.css" 	 type="text/css" media="all">
<!-- TTF --> <link rel="stylesheet" href="fonts/fontawesome-webfont.ttf" type="text/css" media="all">
<!-- //Font-Awesome-File-Links -->

<!-- Supportive-JavaScript --> <script type="text/javascript" src="js/jquery-2.1.4.min.js"></script>

<!-- chart.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.6.0/Chart.js"></script>

</head>
<!-- //Head -->



<!-- Body -->
<body onload="changeTime();makeChart()">

	<!-- Header -->
	<div class="header-aits" id="home">

		<div class="header-info-w3ls">

			<!-- Navigation -->
			<nav class="navbar container navbar-inverse navbar-default">

				<div class="navbar-header">
					<button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
						<span class="sr-only">Toggle navigation</span>
						<span class="icon-bar"></span>
						<span class="icon-bar"></span>
						<span class="icon-bar"></span>
					</button>
					<!-- Logo -->
					<div class="logo">
						<a class="navbar-brand logo-w3l button" href="index.html" ><font color="#FFF77">SpineReminder</font></a>
					</div>
					<!-- //Logo -->
				</div>

				<div id="navbar" class="navbar-collapse navbar-right collapse">
					<ul class="nav navbar-nav navbar-right cross-effect" id="cross-effect">
						<li><a id="index" href="index.html">首頁</a></li>
						<li><a id="setTime" href="setTime.html">久坐提醒設定</a></li>
						<li><a id="sitError" href="sitError.html">錯誤坐姿一覽</a></li>
						<li><a id="calendar" href="calendar.html">行事曆</a></li>
						<li>分析</li>
					</ul>
				</div><!-- //Navbar-Collapse -->

			</nav>
			<!-- //Navigation -->

		</div>



		<!-- Slider-1 -->
		<div class="slider-w3layouts">
			<ul class="rslides-agileits" id="slider1">
				<li>
					<img src="images/slide-1.jpg" alt="W3layouts Agileits">
				</li>
				<li>
					<img src="images/slide-2.jpg" alt="W3layouts Agileits">
				</li>
				<li>
					<img src="images/slide-3.jpg" alt="W3layouts Agileits">
				</li>
				<li>
					<img src="images/slide-4.jpg" alt="W3layouts Agileits">
				</li>
				<li>
					<img src="images/slide-5.jpg" alt="W3layouts Agileits">
				</li>
				<li>
					<img src="images/slide-6.jpg" alt="W3layouts Agileits">
				</li>
			</ul>
		</div>
		<!-- //Slider-1 -->

		<div class="clearfix"></div>
		
		
		<div>
			<canvas id="LineChart" width="700" height="500"></canvas>
			<div style="text-align:center;">
				<font style="font-family:inherit;font-size:30px;">一周就座時數一覽</font>
			</div>
		</div>
		
		<div>
			<canvas id="PieChart" width="700" height="500"></canvas>
			<div style="text-align:center;">
				<font style="font-family:inherit;font-size:30px;">就坐離座比例</font>
			</div>
		</div>

	</div>
	<!-- //Header -->
	
	
	
	
	
	
	<!-- Function -->
	<script src="https://www.gstatic.com/firebasejs/5.3.0/firebase.js"></script>
	<script>
		var timeOnSit = localStorage.getItem('timeOnSit');
		var timeOffSit = localStorage.getItem('timeOffSit');
		var time = localStorage.getItem("time");
		var IsAlarm = false;
		var picktime = true;
		var timer=null;
		
	
		var config = {
			apiKey: "AIzaSyCsevat-cSK1iNpQaT8MtWVLEjApLxp51c",
			authDomain: "aduinodb.firebaseapp.com",
			databaseURL: "https://aduinodb.firebaseio.com",
			projectId: "aduinodb",
			storageBucket: "aduinodb.appspot.com",
			messagingSenderId: "991564246365"
		};
		firebase.initializeApp(config);
	
		function changeTime()
		{
		
			clearInterval(timer);
			// setInterval() 方法可按照指定的周期（以毫秒计）来调用函数或计算表达式。
			timer=setInterval(function () 
			{
				
				if(localStorage.getItem("flagOnSit")=="true")
				{
					timeOnSit++;
					timeOffSit=0;
					
					if(time!=0)
					{
						if(timeOnSit%time==0)
						{
							updates['/project_test/time'] = true;
							firebase.database().ref().update(updates);
						}
					}
					
					updates['/project_test/time'] = false;
					firebase.database().ref().update(updates);
				}
				else
				{
					timeOffSit++;
					timeOnSit=0;
				}
				localStorage.setItem('timeOnSit',timeOnSit);
				localStorage.setItem('timeOffSit',timeOffSit);
				
			},1000);
			
		}
		
		var dateArray=[];
		var today = new Date();
		var i;
		for(i=1;i<=7;i++)
		{
			var newdate = new Date(today-i*24*3600*1000);
			dateArray[i]=newdate.getMonth()+1+"月"+newdate.getDate()+"日";
		}
		
		
		var lineChartData = {
			labels: [dateArray[7], dateArray[6], dateArray[5], dateArray[4], dateArray[3], dateArray[2], dateArray[1]], //顯示區間名稱
			datasets: [{
				label: '時數', // tootip 出現的名稱
				lineTension: 0, // 曲線的彎度，設0 表示直線
				backgroundColor: "#29b288",  //填滿的背景顏色
				borderColor: "#29b288",  //線的顏色
				borderWidth: 5,
				data: [6.5, 3.5, 5.9, 10.8, 7.6, 8.2, 12.3], // 資料
				fill: false, // 是否填滿色彩
			}/*, {
				label: '罹癌後開始使用',
				lineTension: 0,
				fill: false,
				backgroundColor: "#29b288",
				borderColor: "#29b288",
				borderWidth: 5,
				data: [12, 14, 18, 20, 21, 34, 60, 80, 200],
			},*/]
		};
		
		var pieChartData={
			labels: ["就座","離座"], //顯示區間名稱
			datasets: [{
                    data:[60,90],  //預設資料
                    backgroundColor: [   //資料顏色
						"#00A1FF",
						"#FF0004"
                    ],
                }]
		};
		
		function drawLineCanvas(ctx,data) {
			window.myLine = new Chart(ctx, {  //先建立一個 chart
				type: 'line', // 型態
				data: data,
				options: {
						responsive: true,
						legend: { //是否要顯示圖示
							display: false
						},
						tooltips: { //是否要顯示 tooltip
							enabled: true
						},
						scales: {  //是否要顯示 x、y 軸
							xAxes: [{
								display: true
							}],
							yAxes: [{
								display: true,
								ticks: {
								max: 13,
								min: 0,
								stepSize: 1
							}
							}]
						}
					}
			});
		};
		
		function drawPieCanvas(ctx,data) {
			window.myPie = new Chart(ctx, {  //先建立一個 chart
				type: 'pie', // 型態
				data: data,
				options:
				{
					legend: { //是否要顯示圖示
							display: false
						},
						tooltips: { //是否要顯示 tooltip
							enabled: true
						}
				}
			});
		};
		
		function makeChart()
		{
			var ctx = document.getElementById("LineChart").getContext("2d");
			drawLineCanvas(ctx,lineChartData);
			ctx = document.getElementById("PieChart").getContext("2d");
			drawPieCanvas(ctx,pieChartData);
		}


		
	</script>
	
	<!--
	<script src="https://www.gstatic.com/firebasejs/5.3.0/firebase.js"></script>
	<script>
		// Initialize Firebase
		var config = {
			apiKey: "AIzaSyCsevat-cSK1iNpQaT8MtWVLEjApLxp51c",
			authDomain: "aduinodb.firebaseapp.com",
			databaseURL: "https://aduinodb.firebaseio.com",
			projectId: "aduinodb",
			storageBucket: "aduinodb.appspot.com",
			messagingSenderId: "991564246365"
		};
		firebase.initializeApp(config);
	  		
		function setTime()
		{
		var time = document.getElementById("time");

		firebase.database().ref('/project_test/').once('value').then(function(snapshot) {
		//抓資料
		//var time = "設定時間為"+snapshot.val().time;
			});
			
		var updates = {};
		updates['/project_test/time'] = time.value;
		firebase.database().ref().update(updates);
		}
		  
		
	</script>
	-->

	<!-- Custom-JavaScript-File-Links -->

		
		<!-- Necessary-JS-File-For-Bootstrap --> <script type="text/javascript" src="js/bootstrap.min.js"></script>

		<!-- Slider-JavaScript -->
			<script src="js/responsiveslides.min.js"></script>
			<script>
				$(function () {
					$("#slider1, #slider2").responsiveSlides({
						auto: true,
						nav: true,
						speed: 1500,
						namespace: "callbacks",
						pager: true,
					});
				});
			</script>
		<!-- //Slider-JavaScript -->


		<!-- Slide-To-Top JavaScript -->
			<script type="text/javascript">
				$(document).ready(function() {
					var defaults = {
						containerID: 'toTop', // fading element id
						containerHoverID: 'toTopHover', // fading element hover id
						scrollSpeed: 100,
						easingType: 'linear'
					};
					$().UItoTop({ easingType: 'easeOutQuart' });
				});
			</script>
			<a href="#" class="W3layoutsw3lts Agileitsaits" id="toTop" style="display: block;"> <span id="toTopHover" style="opacity: 0;"> </span></a>
		<!-- //Slide-To-Top JavaScript -->

		<!-- Smooth-Scrolling-JavaScript -->
			<script type="text/javascript" src="js/move-top.js"></script>
			<script type="text/javascript" src="js/easing.js">
				
			</script>
			<script type="text/javascript">
				jQuery(document).ready(function($) {
					$(".scroll").click(function(event){
						event.preventDefault();
						$('html,body').animate({scrollTop:$(this.hash).offset().top},1000);
					});
				});
			</script>
		<!-- //Smooth-Scrolling-JavaScript -->

	<!-- //Custom-JavaScript-File-Links -->



</body>
<!-- //Body -->

</html>